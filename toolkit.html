<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Toolkit - VistaVoyage</title>
    <style>
        body { font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; max-width: 600px; margin: 2rem auto; padding: 1rem; line-height: 1.6; }
        h1 { color: #333; }
        input { padding: 10px; font-size: 1rem; border: 1px solid #ccc; border-radius: 4px; width: 250px; }
        button { padding: 10px 20px; font-size: 1rem; color: #fff; background-color: #007bff; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        #weatherResult { margin-top: 20px; padding: 15px; background-color: #f9f9f9; border: 1px solid #eee; border-radius: 5px; }
        #weatherResult h3 { margin-top: 0; }
        #weatherResult img { vertical-align: middle; margin-right: 10px; }
    </style>
</head>
<body>

    <h1>Weather Toolkit</h1>
    <p>Enter a city name to get the current weather conditions.</p>

    <form id="weatherForm">
        <input type="text" id="cityInput" placeholder="e.g., Roodepoort" required>
        <button type="submit">Get Weather</button>
    </form>

    <div id="weatherResult">
        <p>Your weather report will appear here.</p>
    </div>

    <script>
        const form = document.getElementById('weatherForm');
        const cityInput = document.getElementById('cityInput');
        const weatherResultDiv = document.getElementById('weatherResult');

        form.addEventListener('submit', async (event) => {
            event.preventDefault();
            const city = cityInput.value;
            weatherResultDiv.innerHTML = `<p>Fetching weather for ${city}...</p>`;

            try {
                const response = await fetch(`/api/get-weather?city=${city}`);
                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.error || `HTTP error! status: ${response.status}`);
                }

                if (data.error) {
                  weatherResultDiv.innerHTML = `<p>Error: ${data.error.message}</p>`;
                } else {
                  const location = data.location.name;
                  const country = data.location.country;
                  const temp = data.current.temp_c;
                  const condition = data.current.condition.text;
                  const icon = `https:${data.current.condition.icon}`;
                  
                  weatherResultDiv.innerHTML = `
                      <h3>Weather in ${location}, ${country}</h3>
                      <p style="font-size: 1.2rem; display: flex; align-items: center;">
                        <img src="${icon}" alt="${condition}">
                        <span><strong>${temp}Â°C, ${condition}</strong></span>
                      </p>
                  `;
                }
            } catch (error) {
                console.error('Fetch error:', error);
                weatherResultDiv.innerHTML = `<p>Sorry, something went wrong. Could not fetch weather data. Please check the city name and try again.</p>`;
            }
        });
    </script>

</body>
</html>
